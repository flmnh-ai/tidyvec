<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Getting Started with TidyVec • tidyvec</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Getting Started with TidyVec">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">tidyvec</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/getting-started.html">Getting Started</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Getting Started with TidyVec</h1>
                        <h4 data-toc-skip class="author">Nick
Gauthier</h4>
            
            <h4 data-toc-skip class="date">2025-02-25</h4>
      

      <div class="d-none name"><code>getting-started.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>TidyVec is a lightweight package that brings vector embeddings and
similarity search to the tidyverse ecosystem. It allows you to store
embeddings alongside your data in tibbles and perform vector search
operations while maintaining the ability to use all your familiar dplyr
verbs.</p>
<p>This vignette will show you how to:</p>
<ol style="list-style-type: decimal">
<li>Create vector collections</li>
<li>Generate embeddings for text and images</li>
<li>Find similar items using vector search</li>
<li>Visualize embedding spaces</li>
<li>Combine vector search with tidyverse operations</li>
</ol>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install TidyVec from GitHub:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("devtools")</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"flmnh-ai/tidyvec"</span><span class="op">)</span></span></code></pre></div>
<p>Load the required packages:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://flmnh-ai.github.io/tidyvec">tidyvec</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="creating-a-vector-collection">Creating a Vector Collection<a class="anchor" aria-label="anchor" href="#creating-a-vector-collection"></a>
</h2>
<p>At its core, TidyVec treats vector collections as enhanced tibbles.
Any tibble can be converted to a vector collection using the
<code><a href="../reference/vec.html">vec()</a></code> function:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create a simple dataset</span></span>
<span><span class="va">books</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"book1"</span>, <span class="st">"book2"</span>, <span class="st">"book3"</span>, <span class="st">"book4"</span>, <span class="st">"book5"</span><span class="op">)</span>,</span>
<span>  title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"The Art of Data Science"</span>,</span>
<span>    <span class="st">"Advanced R Programming"</span>,</span>
<span>    <span class="st">"Tidy Data Visualization"</span>,</span>
<span>    <span class="st">"Statistical Learning Methods"</span>,</span>
<span>    <span class="st">"Machine Learning with R"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  author <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Smith"</span>, <span class="st">"Jones"</span>, <span class="st">"Brown"</span>, <span class="st">"Davis"</span>, <span class="st">"Wilson"</span><span class="op">)</span>,</span>
<span>  year <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2018</span>, <span class="fl">2020</span>, <span class="fl">2019</span>, <span class="fl">2021</span>, <span class="fl">2022</span><span class="op">)</span>,</span>
<span>  description <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"A comprehensive guide to data analysis using modern techniques"</span>,</span>
<span>    <span class="st">"Deep dive into R programming for advanced users"</span>,</span>
<span>    <span class="st">"Creating beautiful visualizations with ggplot2 and the tidyverse"</span>,</span>
<span>    <span class="st">"Introduction to statistical learning methods and their applications"</span>,</span>
<span>    <span class="st">"Practical machine learning approaches with R examples"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Convert to a vector collection</span></span>
<span><span class="va">books_vec</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/vec.html">vec</a></span><span class="op">(</span><span class="va">books</span><span class="op">)</span></span>
<span><span class="va">books_vec</span></span>
<span><span class="co">#&gt; Tidyvec collection with 5 items</span></span>
<span><span class="co">#&gt; Embedding column: embedding </span></span>
<span><span class="co">#&gt; Has embedding function: No </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 5 × 6</span></span></span>
<span><span class="co">#&gt;   id    title                        author  year description          embedding</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> book1 The Art of Data Science      Smith   <span style="text-decoration: underline;">2</span>018 A comprehensive gui… <span style="color: #949494;">&lt;NULL&gt;</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> book2 Advanced R Programming       Jones   <span style="text-decoration: underline;">2</span>020 Deep dive into R pr… <span style="color: #949494;">&lt;NULL&gt;</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> book3 Tidy Data Visualization      Brown   <span style="text-decoration: underline;">2</span>019 Creating beautiful … <span style="color: #949494;">&lt;NULL&gt;</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> book4 Statistical Learning Methods Davis   <span style="text-decoration: underline;">2</span>021 Introduction to sta… <span style="color: #949494;">&lt;NULL&gt;</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> book5 Machine Learning with R      Wilson  <span style="text-decoration: underline;">2</span>022 Practical machine l… <span style="color: #949494;">&lt;NULL&gt;</span></span></span></code></pre></div>
<p>By default, a column named <code>embedding</code> will be created to
store vector embeddings.</p>
</div>
<div class="section level2">
<h2 id="generating-embeddings">Generating Embeddings<a class="anchor" aria-label="anchor" href="#generating-embeddings"></a>
</h2>
<p>For this example, we’ll use a simple TF-IDF embedder for our text
data:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create a TF-IDF embedder from our descriptions</span></span>
<span><span class="va">embedder</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/embedder_tfidf.html">embedder_tfidf</a></span><span class="op">(</span><span class="va">books</span><span class="op">$</span><span class="va">description</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Update our collection with the embedding function</span></span>
<span><span class="va">books_vec</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/vec.html">vec</a></span><span class="op">(</span><span class="va">books</span>, embedding_fn <span class="op">=</span> <span class="va">embedder</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Generate embeddings for the description column</span></span>
<span><span class="va">books_vec</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/embed.html">embed</a></span><span class="op">(</span><span class="va">books_vec</span>, content_column <span class="op">=</span> <span class="st">"description"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Look at the result</span></span>
<span><span class="va">books_vec</span></span>
<span><span class="co">#&gt; Tidyvec collection with 5 items</span></span>
<span><span class="co">#&gt; Embedding column: embedding </span></span>
<span><span class="co">#&gt; Has embedding function: Yes </span></span>
<span><span class="co">#&gt; Embedding dimension: 5 </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 5 × 6</span></span></span>
<span><span class="co">#&gt;   id    title                        author  year description          embedding</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> book1 The Art of Data Science      Smith   <span style="text-decoration: underline;">2</span>018 A comprehensive gui… <span style="color: #949494;">&lt;dbl [5]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> book2 Advanced R Programming       Jones   <span style="text-decoration: underline;">2</span>020 Deep dive into R pr… <span style="color: #949494;">&lt;dbl [5]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> book3 Tidy Data Visualization      Brown   <span style="text-decoration: underline;">2</span>019 Creating beautiful … <span style="color: #949494;">&lt;dbl [5]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> book4 Statistical Learning Methods Davis   <span style="text-decoration: underline;">2</span>021 Introduction to sta… <span style="color: #949494;">&lt;dbl [5]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> book5 Machine Learning with R      Wilson  <span style="text-decoration: underline;">2</span>022 Practical machine l… <span style="color: #949494;">&lt;dbl [5]&gt;</span></span></span></code></pre></div>
<p>Each book now has an embedding vector derived from its
description.</p>
</div>
<div class="section level2">
<h2 id="finding-similar-items">Finding Similar Items<a class="anchor" aria-label="anchor" href="#finding-similar-items"></a>
</h2>
<p>Now we can find books similar to a text query:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Find books similar to a query</span></span>
<span><span class="va">query_results</span> <span class="op">&lt;-</span> <span class="va">books_vec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/nearest.html">nearest</a></span><span class="op">(</span><span class="st">"machine learning and statistics"</span>, n <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># View the results with similarity scores</span></span>
<span><span class="va">query_results</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">title</span>, <span class="va">author</span>, <span class="va">similarity</span><span class="op">)</span></span>
<span><span class="co">#&gt; Tidyvec collection with 3 items</span></span>
<span><span class="co">#&gt; Embedding column: embedding </span></span>
<span><span class="co">#&gt; Has embedding function: Yes </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 3</span></span></span>
<span><span class="co">#&gt;   title                        author similarity</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Statistical Learning Methods Davis       0.816</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Tidy Data Visualization      Brown       0.5  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Machine Learning with R      Wilson      0.408</span></span></code></pre></div>
<p>We can also use the similarity operator <code>%~%</code> for a more
concise syntax:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Using the similarity operator</span></span>
<span><span class="st">"programming in R"</span> <span class="op"><a href="../reference/grapes-twiddle-grapes.html">%~%</a></span> <span class="va">books_vec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">title</span>, <span class="va">author</span>, <span class="va">similarity</span><span class="op">)</span></span>
<span><span class="co">#&gt; Tidyvec collection with 5 items</span></span>
<span><span class="co">#&gt; Embedding column: embedding </span></span>
<span><span class="co">#&gt; Has embedding function: Yes </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 5 × 3</span></span></span>
<span><span class="co">#&gt;   title                        author similarity</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Advanced R Programming       Jones       1    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Machine Learning with R      Wilson      0.577</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> The Art of Data Science      Smith       0    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Tidy Data Visualization      Brown       0    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> Statistical Learning Methods Davis       0</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="combining-with-tidyverse-operations">Combining with Tidyverse Operations<a class="anchor" aria-label="anchor" href="#combining-with-tidyverse-operations"></a>
</h2>
<p>What makes TidyVec special is how seamlessly it integrates with
tidyverse workflows. You can use standard dplyr operations before or
after vector search:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Filter to recent books, then find similar ones</span></span>
<span><span class="va">books_vec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">year</span> <span class="op">&gt;=</span> <span class="fl">2020</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/nearest.html">nearest</a></span><span class="op">(</span><span class="st">"R methods"</span>, n <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">title</span>, <span class="va">year</span>, <span class="va">similarity</span><span class="op">)</span></span>
<span><span class="co">#&gt; Tidyvec collection with 2 items</span></span>
<span><span class="co">#&gt; Embedding column: embedding </span></span>
<span><span class="co">#&gt; Has embedding function: Yes </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 3</span></span></span>
<span><span class="co">#&gt;   title                    year similarity</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Advanced R Programming   <span style="text-decoration: underline;">2</span>020      1    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Machine Learning with R  <span style="text-decoration: underline;">2</span>022      0.577</span></span></code></pre></div>
<p>You can also perform vector search first, then filter the
results:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Find similar books, then filter by similarity threshold</span></span>
<span><span class="va">books_vec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/nearest.html">nearest</a></span><span class="op">(</span><span class="st">"R methods"</span>, n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">similarity</span> <span class="op">&gt;</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">title</span>, <span class="va">similarity</span><span class="op">)</span></span>
<span><span class="co">#&gt; Tidyvec collection with 2 items</span></span>
<span><span class="co">#&gt; Embedding column: embedding </span></span>
<span><span class="co">#&gt; Has embedding function: Yes </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 2</span></span></span>
<span><span class="co">#&gt;   title                   similarity</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Advanced R Programming       1    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Machine Learning with R      0.577</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="working-with-images">Working with Images<a class="anchor" aria-label="anchor" href="#working-with-images"></a>
</h2>
<p>TidyVec excels at working with multimodal data, including images. For
this, we typically use neural embedding models like CLIP via
HuggingFace.</p>
<blockquote>
<p>Note: Using neural embedders requires Python and some dependencies.
Run <code><a href="../reference/setup_python.html">setup_python()</a></code> to set up the required environment.</p>
</blockquote>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Set up the Python environment</span></span>
<span><span class="fu"><a href="../reference/setup_python.html">setup_python</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create a CLIP embedder</span></span>
<span><span class="va">clip_embedder</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/embedder_hf.html">embedder_hf</a></span><span class="op">(</span><span class="st">"openai/clip-vit-base-patch32"</span>, modality <span class="op">=</span> <span class="st">"multimodal"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Get paths to example images included with the package</span></span>
<span><span class="va">img_paths</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  cat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/images"</span>, <span class="st">"cat.jpg"</span>, package <span class="op">=</span> <span class="st">"tidyvec"</span><span class="op">)</span>,</span>
<span>  dog <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/images"</span>, <span class="st">"dog.jpg"</span>, package <span class="op">=</span> <span class="st">"tidyvec"</span><span class="op">)</span>,</span>
<span>  beach <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/images"</span>, <span class="st">"beach.jpg"</span>, package <span class="op">=</span> <span class="st">"tidyvec"</span><span class="op">)</span>,</span>
<span>  mountain <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/images"</span>, <span class="st">"mountain.jpg"</span>, package <span class="op">=</span> <span class="st">"tidyvec"</span><span class="op">)</span>,</span>
<span>  city <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/images"</span>, <span class="st">"city.jpg"</span>, package <span class="op">=</span> <span class="st">"tidyvec"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create an image collection</span></span>
<span><span class="va">images</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">img_paths</span><span class="op">)</span>,</span>
<span>  path <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unname.html" class="external-link">unname</a></span><span class="op">(</span><span class="va">img_paths</span><span class="op">)</span>,</span>
<span>  category <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pet"</span>, <span class="st">"pet"</span>, <span class="st">"nature"</span>, <span class="st">"nature"</span>, <span class="st">"urban"</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/vec.html">vec</a></span><span class="op">(</span>embedding_fn <span class="op">=</span> <span class="va">clip_embedder</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/embed.html">embed</a></span><span class="op">(</span>content_column <span class="op">=</span> <span class="st">"path"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Find images similar to text</span></span>
<span><span class="st">"a cat playing"</span> <span class="op"><a href="../reference/grapes-twiddle-grapes.html">%~%</a></span> <span class="va">images</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">id</span>, <span class="va">path</span>, <span class="va">similarity</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Find images similar to another image</span></span>
<span><span class="fu"><a href="../reference/nearest.html">nearest</a></span><span class="op">(</span><span class="va">images</span>, <span class="st">"images/dog-on-beach.jpg"</span>, n <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Find images similar to text and visualize</span></span>
<span><span class="st">"a dog on a mountain"</span> <span class="op"><a href="../reference/grapes-twiddle-grapes.html">%~%</a></span> <span class="va">images</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/viz_images.html">viz_images</a></span><span class="op">(</span>path_column <span class="op">=</span> <span class="st">"path"</span>, label_columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"id"</span>, <span class="st">"category"</span><span class="op">)</span>, n <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="st">"a dog on a beach"</span> <span class="op"><a href="../reference/grapes-twiddle-grapes.html">%~%</a></span> <span class="va">images</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/viz_images.html">viz_images</a></span><span class="op">(</span>path_column <span class="op">=</span> <span class="st">"path"</span>, label_columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"id"</span>, <span class="st">"category"</span><span class="op">)</span>, n <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="visualizing-embedding-spaces">Visualizing Embedding Spaces<a class="anchor" aria-label="anchor" href="#visualizing-embedding-spaces"></a>
</h2>
<p>TidyVec provides a simple way to visualize your embedding spaces
using dimensionality reduction techniques:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Visualize our book embeddings</span></span>
<span><span class="va">images</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/viz_embeddings.html">viz_embeddings</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"tsne"</span>, labels <span class="op">=</span> <span class="st">"id"</span>, color <span class="op">=</span> <span class="st">"category"</span>, perplexity <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="advanced-use-cases">Advanced Use Cases<a class="anchor" aria-label="anchor" href="#advanced-use-cases"></a>
</h2>
<div class="section level3">
<h3 id="rag-retrieval-augmented-generation">RAG (Retrieval-Augmented Generation)<a class="anchor" aria-label="anchor" href="#rag-retrieval-augmented-generation"></a>
</h3>
<p>TidyVec is perfect for creating simple RAG systems:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Split document into chunks</span></span>
<span><span class="va">document_chunks</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"chunk"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span>,</span>
<span>  text <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"R is a programming language for statistical computing."</span>,</span>
<span>    <span class="st">"The tidyverse is a collection of R packages for data science."</span>,</span>
<span>    <span class="st">"ggplot2 is used for data visualization in R."</span>,</span>
<span>    <span class="st">"dplyr provides functions for data manipulation."</span>,</span>
<span>    <span class="st">"tidyr helps to create tidy data."</span>,</span>
<span>    <span class="st">"purrr enhances R's functional programming capabilities."</span>,</span>
<span>    <span class="st">"readr provides functions to read rectangular data."</span>,</span>
<span>    <span class="st">"tibble is a modern reimagining of the data frame."</span>,</span>
<span>    <span class="st">"stringr provides functions for string manipulation."</span>,</span>
<span>    <span class="st">"forcats provides tools for working with categorical variables."</span></span>
<span>  <span class="op">)</span>,</span>
<span>  source <span class="op">=</span> <span class="st">"R Documentation"</span></span>
<span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/vec.html">vec</a></span><span class="op">(</span>embedding_fn <span class="op">=</span> <span class="fu"><a href="../reference/embedder_tfidf.html">embedder_tfidf</a></span><span class="op">(</span><span class="va">.</span><span class="op">$</span><span class="va">text</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/embed.html">embed</a></span><span class="op">(</span>content_column <span class="op">=</span> <span class="st">"text"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># User query</span></span>
<span><span class="va">query_results</span> <span class="op">&lt;-</span> <span class="va">document_chunks</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/nearest.html">nearest</a></span><span class="op">(</span><span class="st">"How do I visualize data in R?"</span>, n <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Use results to generate answer with an LLM</span></span>
<span><span class="va">query_results</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">text</span>, <span class="va">similarity</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="custom-embedders">Custom Embedders<a class="anchor" aria-label="anchor" href="#custom-embedders"></a>
</h3>
<p>You can easily create custom embedding functions:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create a simple embedder that counts word frequencies</span></span>
<span><span class="va">word_freq_embedder</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">vocabulary</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"r"</span>, <span class="st">"data"</span>, <span class="st">"programming"</span>, <span class="st">"statistics"</span>, <span class="st">"visualization"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">function</span><span class="op">(</span><span class="va">text</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">text</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/chartr.html" class="external-link">tolower</a></span><span class="op">(</span><span class="va">text</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">vapply</a></span><span class="op">(</span><span class="va">vocabulary</span>, <span class="kw">function</span><span class="op">(</span><span class="va">word</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gregexpr</a></span><span class="op">(</span><span class="va">word</span>, <span class="va">text</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span></span>
<span>    <span class="op">}</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Use custom embedder</span></span>
<span><span class="va">simple_embedder</span> <span class="op">&lt;-</span> <span class="fu">word_freq_embedder</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">books_vec</span> <span class="op">&lt;-</span> <span class="va">books</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/vec.html">vec</a></span><span class="op">(</span>embedding_fn <span class="op">=</span> <span class="va">simple_embedder</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/embed.html">embed</a></span><span class="op">(</span>content_column <span class="op">=</span> <span class="st">"description"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Query with custom embedder</span></span>
<span><span class="st">"data visualization"</span> <span class="op"><a href="../reference/grapes-twiddle-grapes.html">%~%</a></span> <span class="va">books_vec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">title</span>, <span class="va">similarity</span><span class="op">)</span></span>
<span><span class="co">#&gt; Tidyvec collection with 5 items</span></span>
<span><span class="co">#&gt; Embedding column: embedding </span></span>
<span><span class="co">#&gt; Has embedding function: Yes </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 5 × 2</span></span></span>
<span><span class="co">#&gt;   title                        similarity</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> The Art of Data Science           0.316</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Tidy Data Visualization           0.316</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Advanced R Programming            0    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Statistical Learning Methods      0    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> Machine Learning with R           0</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h2>
<p>TidyVec provides a lightweight, tidyverse-friendly way to work with
vector embeddings. By treating embeddings as just another column in your
tibbles, you get all the power of vector search while maintaining the
flexibility and familiarity of the tidyverse.</p>
<p>Key benefits:</p>
<ol style="list-style-type: decimal">
<li>Seamless integration with dplyr, ggplot2, and other tidyverse
packages</li>
<li>Support for multiple modalities (text, images)</li>
<li>Flexible embedding generation</li>
<li>Simple, intuitive API</li>
<li>Visualization capabilities</li>
</ol>
<p>For more advanced use cases or larger datasets, consider using FAISS
or other specialized vector databases, but for many common applications,
TidyVec provides an elegant and easy-to-use solution.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Nicolas Gauthier.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1. NULL</p>
</div>

    </footer>
</div>





  </body>
</html>
